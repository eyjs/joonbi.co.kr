# Development Override
# Use: docker-compose -f docker-compose.yml -f docker-compose.dev.yml up -d

services:
  api:
    build:
      context: .
      dockerfile: apps/api/Dockerfile.dev
      args:
        - NODE_ENV=development
    container_name: joonbi-api-dev
    environment:
      - NODE_ENV=development
      - DATABASE_URL=postgresql://admin:vmffpdl2%40@db:5432/joonbi_dev
      - JWT_SECRET=dev-jwt-secret-at-least-32-chars
      - JWT_REFRESH_SECRET=dev-refresh-secret-at-least-32-chars
      - FRONTEND_URL=https://joonbi.co.kr
      - BACKEND_URL=https://api.joonbi.co.kr
      - INTERNAL_API_KEY=dev-internal-api-key
      - DISCORD_WEBHOOK_URL=${DISCORD_WEBHOOK_URL:-}
    volumes:
      - ./apps/api:/workspace/apps/api
      - /workspace/node_modules
      - uploads:/data/uploads
    ports:
      - "8081:4000"  # Development also uses 8081

  db:
    container_name: joonbi-db-dev
    environment:
      - POSTGRES_USER=admin
      - POSTGRES_PASSWORD=vmffpdl2@
      - POSTGRES_DB=joonbi_dev

